<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLE7 Rock Cloud</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root { --glass: rgba(255, 255, 255, 0.35); --bg: radial-gradient(circle at top left, #4facfe 0%, #00f2fe 100%); }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); background-attachment: fixed; margin: 0; padding: 20px; display: flex; justify-content: center; color: #003366; }
        .container { width: 100%; max-width: 900px; background: var(--glass); backdrop-filter: blur(20px); border-radius: 30px; border: 1px solid rgba(255, 255, 255, 0.4); padding: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.2); }
        .btn { background: linear-gradient(to bottom, #ffffff 0%, #cedbe9 100%); color: #003366; border: 1px solid #707070; padding: 10px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; margin: 5px; }
        .btn-main { background: linear-gradient(to bottom, #87e8fb 0%, #1ea1d7 100%); color: white; border-color: #1e70a1; }
        .hidden { display: none !important; }
        input, textarea { width: 100%; background: rgba(255,255,255,0.8); border: 1px solid #ccc; padding: 10px; border-radius: 8px; margin-bottom: 10px; box-sizing: border-box; }
        .band-card { background: rgba(255,255,255,0.5); padding: 15px; border-radius: 15px; margin-bottom: 10px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border: 1px solid white; }
        #v-img-main { width: 200px; height: 200px; border-radius: 15px; object-fit: contain; background: #fff; border: 4px solid #fff; }
        .view-area { background: rgba(255,255,255,0.6); padding: 20px; border-radius: 20px; line-height: 1.6; white-space: pre-wrap; }
        .tabs { display: flex; gap: 5px; margin: 20px 0; }
        .tab { padding: 10px 20px; cursor: pointer; background: rgba(255,255,255,0.2); border-radius: 10px 10px 0 0; }
        .tab.active { background: white; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div id="screen-list">
        <h1 style="text-align:center; color: white;">üé∏ PLE7 ROCK CLOUD</h1>
        <div style="text-align:center;"><button class="btn btn-main" onclick="openNewEditor()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É</button></div>
        <div id="bands-container" style="margin-top:20px;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div id="screen-view" class="hidden">
        <button class="btn" onclick="showScreen('screen-list')">‚Ü© –ù–∞–∑–∞–¥</button>
        <div style="display:flex; gap:20px; align-items:center; margin-top:20px;">
            <img id="v-img-main">
            <div style="flex:1"><h1 id="v-name" style="margin:0;"></h1><p id="v-year"></p><audio id="v-audio" controls style="width:100%"></audio></div>
        </div>
        <div class="tabs">
            <div class="tab active" onclick="switchTab('v-bio', this)">–ò—Å—Ç–æ—Ä–∏—è</div>
            <div class="tab" onclick="switchTab('v-disco', this)">–î–∏—Å–∫–æ–≥—Ä–∞—Ñ–∏—è</div>
        </div>
        <div id="v-bio" class="view-area tab-content"></div>
        <div id="v-disco" class="view-area tab-content hidden"></div>
    </div>

    <div id="screen-edit" class="hidden">
        <h2>–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</h2>
        <input type="text" id="e-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
        <input type="text" id="e-year" placeholder="–ì–æ–¥">
        <label>–§–æ—Ç–æ:</label><input type="file" onchange="encodeMedia(this, 'img')">
        <label>–ú—É–∑—ã–∫–∞:</label><input type="file" onchange="encodeMedia(this, 'audio')">
        <textarea id="e-bio" placeholder="–ò—Å—Ç–æ—Ä–∏—è..."></textarea>
        <textarea id="e-disco" placeholder="–î–∏—Å–∫–æ–≥—Ä–∞—Ñ–∏—è..."></textarea>
        <button class="btn btn-main" style="width:100%" id="save-btn" onclick="saveData()">‚òÅ –°–û–•–†–ê–ù–ò–¢–¨ –í –û–ë–õ–ê–ö–û</button>
        <button class="btn" style="width:100%" onclick="showScreen('screen-list')">–û—Ç–º–µ–Ω–∞</button>
    </div>
</div>

<script>
    // –¢–í–û–ò –ö–õ–Æ–ß–ò –ò–ó –°–ö–†–ò–ù–®–û–¢–ê
    const firebaseConfig = {
        apiKey: "AIzaSyCCMz8l4I6c6TKTiR4jGsmIjrKtyQdWIno",
        authDomain: "ple7-edit-v1.firebaseapp.com",
        databaseURL: "https://ple7-edit-v1-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "ple7-edit-v1",
        storageBucket: "ple7-edit-v1.firebasestorage.app",
        messagingSenderId: "779852816376",
        appId: "1:779852816376:web:be6b45d7e2290f7192000d"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    let tempMedia = {};

    function loadBands() {
        db.ref('bands').on('value', (snap) => {
            const container = document.getElementById('bands-container');
            container.innerHTML = "";
            const data = snap.val();
            for (let id in data) {
                let card = document.createElement('div');
                card.className = 'band-card';
                card.innerHTML = `<b>${data[id].name}</b> <span>‚ñ∂</span>`;
                card.onclick = () => showBand(data[id]);
                container.appendChild(card);
            }
        });
    }

    function encodeMedia(input, key) {
        const reader = new FileReader();
        reader.onloadend = () => tempMedia[key] = reader.result;
        reader.readAsDataURL(input.files[0]);
    }

    function saveData() {
        const name = document.getElementById('e-name').value;
        if (!name) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è!");
        db.ref('bands').push({
            name: name, year: document.getElementById('e-year').value,
            bio: document.getElementById('e-bio').value, disco: document.getElementById('e-disco').value,
            img: tempMedia.img || "", audio: tempMedia.audio || ""
        }).then(() => showScreen('screen-list'));
    }

    function showBand(data) {
        document.getElementById('v-name').innerText = data.name;
        document.getElementById('v-year').innerText = data.year;
        document.getElementById('v-bio').innerText = data.bio;
        document.getElementById('v-disco').innerText = data.disco;
        document.getElementById('v-img-main').src = data.img || "";
        document.getElementById('v-audio').src = data.audio || "";
        showScreen('screen-view');
    }

    function showScreen(id) {
        document.querySelectorAll('.container > div').forEach(s => s.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function openNewEditor() {
        tempMedia = {};
        document.querySelectorAll('input, textarea').forEach(i => i.value = "");
        showScreen('screen-edit');
    }

    function switchTab(id, el) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById(id).classList.remove('hidden');
        el.classList.add('active');
    }

    loadBands();
</script>
</body>
</html>
