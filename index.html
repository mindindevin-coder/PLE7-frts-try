<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLE7 ROCK CLOUD</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.25);
            --border: rgba(255, 255, 255, 0.4);
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #74ebd5 0%, #9face6 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #1d1d1f;
        }

        #app-container {
            width: 95%;
            max-width: 900px;
            height: 90vh;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .screen { display: none; flex: 1; overflow-y: auto; padding: 25px; }
        .active { display: block; }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .btn:active { transform: scale(0.95); }
        .btn-main { background: white; color: #333; }
        .btn-add { background: linear-gradient(135deg, #0071bc, #29abe2); color: white; }
        .btn-save { background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; width: 100%; margin-top: 20px; }
        .btn-delete { background: #ff4b2b; color: white; padding: 8px 15px; font-size: 0.85em; }

        /* Cards */
        .band-card {
            background: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.5);
            transition: 0.3s;
        }

        .band-card:hover { background: white; transform: translateX(10px); }
        .band-thumb { width: 70px; height: 70px; border-radius: 12px; object-fit: cover; }

        /* Detail View */
        .detail-header { display: flex; flex-wrap: wrap; gap: 25px; margin-bottom: 30px; }
        .detail-img { width: 220px; height: 220px; border-radius: 25px; object-fit: cover; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; background: rgba(0,0,0,0.05); padding: 5px; border-radius: 15px; }
        .tab { flex: 1; padding: 10px; text-align: center; cursor: pointer; border-radius: 10px; transition: 0.2s; font-size: 0.9em; }
        .tab.active-tab { background: white; box-shadow: 0 4px 10px rgba(0,0,0,0.05); font-weight: bold; }

        audio { width: 100%; margin-top: 15px; height: 45px; border-radius: 30px; }

        input, textarea {
            width: 100%; padding: 14px; margin: 8px 0; border-radius: 12px; border: 1px solid rgba(0,0,0,0.1); 
            background: rgba(255,255,255,0.7); font-family: inherit;
        }
    </style>
</head>
<body>

<div id="app-container">
    <header>
        <h2 style="margin:0; font-weight: 800; color: #004e92; letter-spacing: -1px;">ROCK CLOUD</h2>
        <button class="btn btn-add" onclick="openNewEditor()"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å</button>
    </header>

    <div id="screen-list" class="screen active">
        <div id="bands-container">–ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞...</div>
    </div>

    <div id="screen-edit" class="screen">
        <button class="btn btn-main" onclick="showScreen('screen-list')">‚Üê –ù–∞–∑–∞–¥</button>
        <h3>–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</h3>
        <input type="text" id="e-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã">
        <input type="text" id="e-year" placeholder="–ñ–∞–Ω—Ä –∏ –ì–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: Thrash Metal, 1997)">
        <textarea id="e-history" rows="4" placeholder="–ò—Å—Ç–æ—Ä–∏—è (Must have –¥–ª—è —Ñ–∞–Ω–æ–≤ Annihilator...)"></textarea>
        <textarea id="e-disco" rows="2" placeholder="–î–∏—Å–∫–æ–≥—Ä–∞—Ñ–∏—è (–ê–ª—å–±–æ–º—ã)"></textarea>
        <textarea id="e-lyrics" rows="2" placeholder="–¢–µ–∫—Å—Ç—ã"></textarea>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
            <label class="btn btn-main" style="justify-content:center;">üñºÔ∏è –§–æ—Ç–æ<input type="file" hidden onchange="encodeMedia(this, 'img')"></label>
            <label class="btn btn-main" style="justify-content:center;">üéµ –ê—É–¥–∏–æ<input type="file" hidden onchange="encodeMedia(this, 'audio')"></label>
        </div>
        <button class="btn btn-save" onclick="saveData()" id="save-btn">–°–û–•–†–ê–ù–ò–¢–¨ –í –û–ë–õ–ê–ö–û</button>
    </div>

    <div id="screen-view" class="screen">
        <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
            <button class="btn btn-main" onclick="showScreen('screen-list')">‚Üê –ö —Å–ø–∏—Å–∫—É</button>
            <div id="admin-tools"></div>
        </div>
        <div id="view-content"></div>
    </div>
</div>

<script>
    // –ö–û–ù–§–ò–ì
    const firebaseConfig = {
        databaseURL: "https://ple7-frts-try-default-rtdb.europe-west1.firebasedatabase.app/"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    // –ü–ê–†–û–õ–¨
    const ADMIN_PASS = "immaimdhiesyf";

    let tempMedia = {};

    // –ó–∞–≥—Ä—É–∑–∫–∞
    db.ref('bands').on('value', (snap) => {
        const container = document.getElementById('bands-container');
        container.innerHTML = "";
        const data = snap.val();
        if(!data) { container.innerHTML = "–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç"; return; }
        
        for (let id in data) {
            const b = data[id];
            container.innerHTML += `
                <div class="band-card" onclick="viewBand('${id}')">
                    <img src="${b.img || 'https://via.placeholder.com/80'}" class="band-thumb">
                    <div>
                        <strong style="font-size:1.2em; display:block;">${b.name}</strong>
                        <span style="color: #555; font-size:0.9em;">${b.year || ''}</span>
                    </div>
                </div>
            `;
        }
    });

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤—Ö–æ–¥–µ
    function openNewEditor() {
        if (prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:") === ADMIN_PASS) {
            tempMedia = {};
            document.querySelectorAll('#screen-edit input, #screen-edit textarea').forEach(i => i.value = "");
            showScreen('screen-edit');
        } else { alert("–î–æ—Å—Ç—É–ø –∑–∞–∫—Ä—ã—Ç"); }
    }

    function viewBand(id) {
        db.ref('bands/' + id).once('value', (snap) => {
            const b = snap.val();
            const container = document.getElementById('view-content');
            document.getElementById('admin-tools').innerHTML = `
                <button class="btn btn-delete" onclick="deleteThisBand('${id}')"><i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å</button>
            `;

            container.innerHTML = `
                <div class="detail-header">
                    <img src="${b.img || ''}" class="detail-img">
                    <div style="flex:1; min-width: 250px;">
                        <h1 style="margin:0; color: #004e92; font-size: 2.5em;">${b.name}</h1>
                        <p style="color: #666; font-weight: 600;">${b.year}</p>
                        ${b.audio ? `<audio controls src="${b.audio}"></audio>` : '<p style="opacity:0.5"><i>–ê—É–¥–∏–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</i></p>'}
                    </div>
                </div>
                <div class="tabs">
                    <div class="tab active-tab" onclick="switchTab(this, 'history')">–ò—Å—Ç–æ—Ä–∏—è</div>
                    <div class="tab" onclick="switchTab(this, 'disco')">–î–∏—Å–∫–æ–≥—Ä–∞—Ñ–∏—è</div>
                    <div class="tab" onclick="switchTab(this, 'lyrics')">–¢–µ–∫—Å—Ç—ã</div>
                </div>
                <div id="tab-content" style="background: rgba(255,255,255,0.5); padding: 25px; border-radius: 20px; white-space: pre-wrap;">${b.history}</div>
            `;
            window.currentBandData = b;
            showScreen('screen-view');
        });
    }

    function switchTab(el, type) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active-tab'));
        el.classList.add('active-tab');
        const b = window.currentBandData;
        document.getElementById('tab-content').innerText = b[type] || "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç";
    }

    function encodeMedia(input, type) {
        const reader = new FileReader();
        reader.onloadend = () => { tempMedia[type] = reader.result; };
        reader.readAsDataURL(input.files[0]);
    }

    function saveData() {
        const btn = document.getElementById('save-btn');
        btn.innerText = "–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø...";
        btn.disabled = true;

        const data = {
            name: document.getElementById('e-name').value,
            year: document.getElementById('e-year').value,
            history: document.getElementById('e-history').value,
            disco: document.getElementById('e-disco').value,
            lyrics: document.getElementById('e-lyrics').value,
            img: tempMedia.img || "",
            audio: tempMedia.audio || ""
        };

        db.ref('bands').push(data).then(() => {
            btn.innerText = "–°–û–•–†–ê–ù–ò–¢–¨ –í –û–ë–õ–ê–ö–û";
            btn.disabled = false;
            showScreen('screen-list');
        }).catch(e => { alert("–û—à–∏–±–∫–∞!"); btn.disabled = false; });
    }

    function deleteThisBand(id) {
        if (prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:") === ADMIN_PASS) {
            if (confirm("–£–¥–∞–ª–∏—Ç—å –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ?")) {
                db.ref('bands/' + id).remove().then(() => showScreen('screen-list'));
            }
        } else { alert("–û—Ç–∫–∞–∑"); }
    }
</script>
</body>
</html>
